CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(100),
    age INT
);

import mysql.connector
import psycopg2

# MySQL connection
mysql_conn = mysql.connector.connect(
    host="localhost",
    user="root",
    password="password",
    database="source_db"
)

# PostgreSQL connection
pg_conn = psycopg2.connect(
    host="localhost",
    user="postgres",
    password="password",
    database="target_db"
)

mysql_cursor = mysql_conn.cursor()
pg_cursor = pg_conn.cursor()

# Fetch data from MySQL
mysql_cursor.execute("SELECT id, name, email, age FROM users")
rows = mysql_cursor.fetchall()

# Insert data into PostgreSQL
for row in rows:
    pg_cursor.execute(
        "INSERT INTO users (id, name, email, age) VALUES (%s, %s, %s, %s)",
        row
    )

pg_conn.commit()

print("Data migration completed successfully!")

mysql_cursor.close()
pg_cursor.close()
mysql_conn.close()
pg_conn.close()

SELECT COUNT(*) FROM users;
